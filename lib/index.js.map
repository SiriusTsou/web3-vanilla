{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/connectors/connector.js","webpack:///./src/connectors/index.js","webpack:///./src/connectors/injected.js","webpack:///./src/connectors/networkOnly.js","webpack:///./src/connectors/privateKey.js","webpack:///./src/connectors/walletConnect.js","webpack:///./src/index.js","webpack:///./src/manager.js","webpack:///./src/provider.js","webpack:///./src/state.js","webpack:///external \"@0x/subproviders\"","webpack:///external \"ethers\"","webpack:///external \"events\""],"names":["ErrorCodeMixin","Base","errorCodes","constructor","kwargs","reduce","accumulator","currentValue","ConnectorErrorCodes","Connector","EventEmitter","supportedNetworks","onActivation","onDeactivation","_error","getProvider","networkId","getNetworkId","provider","library","ethers","providers","Web3Provider","getNetwork","then","network","chainId","_validateNetworkId","getAccount","account","listAccounts","accounts","includes","unsupportedNetworkError","Error","code","UNSUPPORTED_NETWORK","_web3UpdateHandler","options","emit","_web3ErrorHandler","error","preserveConnector","_web3ResetHandler","InjectedConnectorErrorCodes","InjectedConnector","args","runOnDeactivation","networkChangedHandler","bind","accountsChangedHandler","ethereum","web3","window","enable","catch","deniedAccessError","ETHEREUM_ACCESS_DENIED","on","push","removeListener","isMetaMask","autoRefreshOnNetworkChange","legacyError","LEGACY_PROVIDER","noWeb3Error","NO_WEB3","unlockRequiredError","UNLOCK_REQUIRED","forEach","runner","networkIdNumber","Number","updateNetworkId","updateAccount","NetworkOnlyConnector","supportedNetworkURLs","defaultNetwork","Object","keys","map","supportedNetworkURL","engine","Web3ProviderEngine","addProvider","RPCSubprovider","providerURL","start","networkIdToUse","stop","PrivateKeyConnector","privateKey","PrivateKeyWalletSubprovider","WalletConnectConnector","api","WalletConnectSubprovider","bridge","qrcode","connectAndSessionUpdateHandler","disconnectHandler","walletConnectSubprovider","walletConnector","_walletConnector","connected","createSession","payload","params","ManagerErrorCodes","unexpectedErrorMessage","unexpectedError","UNEXPECTED_ERROR","initialWeb3State","undefined","connectorName","normalizeAccount","utils","getAddress","useRef","initialValue","ref","current","useRefId","refId","increment","Web3Manager","connectors","incrementRefId","web3State","Web3State","web3Initialized","activeConnector","updateWeb3State","state","active","actionWeb3State","action","type","console","warn","setError","offConnector","onConnector","web3UpdateHandler","web3ErrorHandler","web3ResetHandler","setConnector","suppressAndThrowErrors","callingTimeRefId","validConnectorNames","connector","join","networkIdPromise","accountPromise","Promise","all","toString","setFirstValidConnector","connectorNames","networkIds","indexOf","length","ALL_CONNECTORS_INVALID","unsetConnector","overrideNetworkIdCheck","overrideAccountCheck","fetchNewProvider","fetchNewNetworkId","fetchNewAccount","returnedNetworkId","returnedAccount","libraryName","web3Api","_libraryName","_web3Manger","providerToInject","event","_account","_connectorName","_networkId","_provider","_active"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@0x/subproviders\"), require(\"ethers\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@0x/subproviders\", \"ethers\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"@0x/subproviders\"), require(\"ethers\")) : factory(root[\"@0x/subproviders\"], root[\"ethers\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, function(__WEBPACK_EXTERNAL_MODULE__0x_subproviders__, __WEBPACK_EXTERNAL_MODULE_ethers__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import { ethers } from 'ethers'\nimport EventEmitter from 'events'\n\nexport function ErrorCodeMixin(Base, errorCodes) {\n  return class extends Base {\n    constructor(kwargs = {}) {\n      super(kwargs)\n    }\n\n    static get errorCodes() {\n      return errorCodes.reduce((accumulator, currentValue) => {\n        accumulator[currentValue] = currentValue\n        return accumulator\n      }, {})\n    }\n  }\n}\n\nconst ConnectorErrorCodes = ['UNSUPPORTED_NETWORK']\nexport default class Connector extends ErrorCodeMixin(EventEmitter, ConnectorErrorCodes) {\n  constructor(kwargs = {}) {\n    super()\n    const { supportedNetworks } = kwargs\n    this.supportedNetworks = supportedNetworks\n  }\n\n  async onActivation() {}\n  onDeactivation(_error) {}\n  async getProvider(networkId) {}\n\n  async getNetworkId(provider) {\n    const library = new ethers.providers.Web3Provider(provider)\n    const networkId = await library.getNetwork().then((network) => network.chainId)\n    return this._validateNetworkId(networkId)\n  }\n\n  async getAccount(provider) {\n    const library = new ethers.providers.Web3Provider(provider)\n    const account = await library.listAccounts().then((accounts) => accounts[0] || null)\n    return account\n  }\n\n  _validateNetworkId(networkId) {\n    if (this.supportedNetworks && !this.supportedNetworks.includes(networkId)) {\n      const unsupportedNetworkError = Error(`Unsupported Network: ${networkId}.`)\n      unsupportedNetworkError.code = Connector.errorCodes.UNSUPPORTED_NETWORK\n      throw unsupportedNetworkError\n    }\n\n    return networkId\n  }\n\n  // wraps emissions of _web3Update\n  _web3UpdateHandler(options) {\n    this.emit('_web3Update', options)\n  }\n\n  // wraps emissions of _web3Error\n  _web3ErrorHandler(error, preserveConnector = true) {\n    this.emit('_web3Error', error, preserveConnector)\n  }\n\n  // wraps emissions of _web3Error\n  _web3ResetHandler() {\n    this.emit('_web3Reset')\n  }\n}\n","export { default as Connector } from './connector'\nexport * from './connector'\nexport { default as InjectedConnector } from './injected'\nexport { default as NetworkOnlyConnector } from './networkOnly'\nexport { default as PrivateKeyConnector } from './privateKey'\nexport { default as WalletConnectConnector } from './walletConnect'\n","import Connector, { ErrorCodeMixin, ConnectorArguments } from './connector'\n\nconst InjectedConnectorErrorCodes = ['ETHEREUM_ACCESS_DENIED', 'LEGACY_PROVIDER', 'NO_WEB3', 'UNLOCK_REQUIRED']\nexport default class InjectedConnector extends ErrorCodeMixin(Connector, InjectedConnectorErrorCodes) {\n  constructor(args = {}) {\n    super(args)\n\n    this.runOnDeactivation = []\n\n    this.networkChangedHandler = this.networkChangedHandler.bind(this)\n    this.accountsChangedHandler = this.accountsChangedHandler.bind(this)\n  }\n\n  async onActivation() {\n    const { ethereum, web3 } = window\n\n    if (ethereum) {\n      await ethereum.enable().catch(\n        (error) => {\n          const deniedAccessError = Error(error)\n          deniedAccessError.code = InjectedConnector.errorCodes.ETHEREUM_ACCESS_DENIED\n          throw deniedAccessError\n        }\n      )\n\n      // initialize event listeners\n      if (ethereum.on) {\n        ethereum.on('networkChanged', this.networkChangedHandler)\n        ethereum.on('accountsChanged', this.accountsChangedHandler)\n\n        this.runOnDeactivation.push(\n          () => {\n            if (ethereum.removeListener) {\n              ethereum.removeListener('networkChanged', this.networkChangedHandler)\n              ethereum.removeListener('accountsChanged', this.accountsChangedHandler)\n            }\n          }\n        )\n      }\n\n      if (ethereum.isMetaMask) {\n        ethereum.autoRefreshOnNetworkChange = false\n      }\n    } else if (web3) {\n      const legacyError = Error('Your web3 provider is outdated, please upgrade to a modern provider.')\n      legacyError.code = InjectedConnector.errorCodes.LEGACY_PROVIDER\n      throw legacyError\n    } else {\n      const noWeb3Error = Error('Your browser is not equipped with web3 capabilities.')\n      noWeb3Error.code = InjectedConnector.errorCodes.NO_WEB3\n      throw noWeb3Error\n    }\n  }\n\n  async getProvider() {\n    const { ethereum } = window\n    return ethereum\n  }\n\n  async getAccount(provider) {\n    const account = super.getAccount(provider)\n\n    if (account === null) {\n      const unlockRequiredError = Error('Ethereum account locked.')\n      unlockRequiredError.code = InjectedConnector.errorCodes.UNLOCK_REQUIRED\n      throw unlockRequiredError\n    }\n\n    return account\n  }\n\n  onDeactivation() {\n    this.runOnDeactivation.forEach((runner) => runner())\n    this.runOnDeactivation = []\n  }\n\n  // event handlers\n  networkChangedHandler(networkId) {\n    const networkIdNumber = Number(networkId)\n\n    try {\n      super._validateNetworkId(networkIdNumber)\n\n      super._web3UpdateHandler({\n        updateNetworkId: true,\n        networkId: networkIdNumber\n      })\n    } catch (error) {\n      super._web3ErrorHandler(error)\n    }\n  }\n\n  accountsChangedHandler(accounts) {\n    if (!accounts[0]) {\n      const unlockRequiredError = Error('Ethereum account locked.')\n      unlockRequiredError.code = InjectedConnector.errorCodes.UNLOCK_REQUIRED\n      super._web3ErrorHandler(unlockRequiredError)\n    } else {\n      super._web3UpdateHandler({\n        updateAccount: true,\n        account: accounts[0]\n      })\n    }\n  }\n}\n","import { RPCSubprovider, Web3ProviderEngine } from '@0x/subproviders'\n\nimport Connector, { ConnectorArguments } from './connector'\n\nexport default class NetworkOnlyConnector extends Connector {\n  constructor(kwargs) {\n    const { supportedNetworkURLs, defaultNetwork } = kwargs\n    \n    const supportedNetworks = Object.keys(supportedNetworkURLs).map(\n      (supportedNetworkURL) => Number(supportedNetworkURL)\n    )\n    super({ supportedNetworks })\n\n    this.supportedNetworkURLs = supportedNetworkURLs\n    this.defaultNetwork = defaultNetwork\n  }\n\n  async onActivation() {\n    if (!this.engine) {\n      const engine = new Web3ProviderEngine()\n      this.engine = engine\n      this.engine.addProvider(new RPCSubprovider(this.providerURL))\n    }\n\n    this.engine.start()\n  }\n\n  async getProvider(networkId = null) {\n    // we have to validate here because networkId might not be a key of supportedNetworkURLs\n    const networkIdToUse = networkId || this.defaultNetwork\n    super._validateNetworkId(networkIdToUse)\n\n    return this.engine\n  }\n\n  async getAccount() {\n    return null\n  }\n\n  onDeactivation() {\n    if (this.engine) {\n      this.engine.stop()\n    }\n  }\n}\n","import { PrivateKeyWalletSubprovider, RPCSubprovider, Web3ProviderEngine } from '@0x/subproviders'\n\nimport Connector, { ConnectorArguments } from './connector'\n\nexport default class PrivateKeyConnector extends Connector {\n  constructor(kwargs) {\n    const { privateKey, supportedNetworkURLs, defaultNetwork } = kwargs\n    \n    const supportedNetworks = Object.keys(supportedNetworkURLs).map(\n      (supportedNetworkURL) => Number(supportedNetworkURL)\n    )\n    super({ supportedNetworks })\n\n    this.privateKey = privateKey\n    this.supportedNetworkURLs = supportedNetworkURLs\n    this.defaultNetwork = defaultNetwork\n  }\n\n  async onActivation() {\n    if (!this.engine) {\n      const engine = new Web3ProviderEngine()\n      this.engine = engine\n      this.engine.addProvider(new PrivateKeyWalletSubprovider(this.privateKey))\n      this.engine.addProvider(new RPCSubprovider(this.providerURL))\n    }\n\n    this.engine.start()\n  }\n\n  async getProvider(networkId = null) {\n    // we have to validate here because networkId might not be a key of supportedNetworkURLs\n    const networkIdToUse = networkId || this.defaultNetwork\n    super._validateNetworkId(networkIdToUse)\n\n    return this.engine\n  }\n\n  async getAccount() {\n    return super.getAccount(provider)\n  }\n\n  onDeactivation() {\n    if (this.engine) {\n      this.engine.stop()\n    }\n  }\n}\n","import { Web3ProviderEngine, RPCSubprovider } from '@0x/subproviders'\n\nimport Connector, { ConnectorArguments } from './connector'\n\nexport default class WalletConnectConnector extends Connector {\n  constructor(kwargs) {\n    const { api: WalletConnectSubprovider, bridge, qrcode, supportedNetworkURLs, defaultNetwork } = kwargs\n\n    const supportedNetworks = Object.keys(supportedNetworkURLs).map(\n      (supportedNetworkURL) => Number(supportedNetworkURL)\n    )\n    super({ supportedNetworks })\n\n    this.WalletConnectSubprovider = WalletConnectSubprovider\n    this.bridge = bridge\n    this.qrcode = qrcode\n    this.supportedNetworkURLs = supportedNetworkURLs\n    this.defaultNetwork = defaultNetwork\n\n    this.connectAndSessionUpdateHandler = this.connectAndSessionUpdateHandler.bind(this)\n    this.disconnectHandler = this.disconnectHandler.bind(this)\n  }\n\n  async onActivation() {\n    if (!this.walletConnectSubprovider && !this.walletConnector) {\n      const walletConnectSubprovider = new this.WalletConnectSubprovider({\n        bridge: this.bridge,\n        qrcode: this.qrcode,\n      })\n      this.walletConnectSubprovider = walletConnectSubprovider\n      this.walletConnector = this.walletConnectSubprovider._walletConnector\n    }\n\n    if (!this.walletConnector.connected) {\n      await this.walletConnector.createSession()\n    }\n\n    // initialize event listeners\n    this.walletConnector.on('connect', this.connectAndSessionUpdateHandler)\n    this.walletConnector.on('session_update', this.connectAndSessionUpdateHandler)\n    this.walletConnector.on('disconnect', this.disconnectHandler)\n  }\n\n  async getProvider(networkId = null) {\n    // this should never happened, because it probably means there was a funky walletconnect race condition\n    if (networkId && this.walletConnector.chainId && networkId !== this.walletConnector.chainId) {\n      throw Error('Unexpected Error in WalletConnectConnector. Please file an issue on Github.')\n    }\n\n    // we have to validate here because networkId might not be a key of supportedNetworkURLs\n    const networkIdToUse = this.walletConnector.chainId || networkId || this.defaultNetwork\n    super._validateNetworkId(networkIdToUse)\n\n    const engine = new Web3ProviderEngine()\n    this.engine = engine\n    engine.addProvider(this.walletConnectSubprovider)\n    engine.addProvider(new RPCSubprovider(this.supportedNetworkURLs[networkIdToUse]))\n    engine.start()\n\n    return engine\n  }\n\n  async getAccount(provider) {\n    if (this.walletConnector.connected) {\n      return super.getAccount(provider)\n    } else {\n      return null\n    }\n  }\n\n  onDeactivation() {\n    // TODO remove listeners here once exposed in walletconnect\n    if (this.engine) {\n      this.engine.stop()\n    }\n  }\n\n  // walletconnect event handlers\n  connectAndSessionUpdateHandler(error, payload) {\n    if (error) {\n      super._web3ErrorHandler(error)\n    } else {\n      const { chainId, accounts } = payload.params[0]\n\n      // proactively handle wrong network errors\n      try {\n        super._validateNetworkId(chainId)\n\n        super._web3UpdateHandler({\n          updateNetworkId: true,\n          updateAccount: true,\n          networkId: chainId,\n          account: accounts[0]\n        })\n      } catch (error) {\n        super._web3ErrorHandler(error)\n      }\n    }\n  }\n\n  disconnectHandler(error) {\n    if (error) {\n      super._web3ErrorHandler(error)\n    } else {\n      super._web3ResetHandler()\n    }\n  }\n}\n","import Web3Provider from './provider'\nexport default Web3Provider\n\nimport * as subproviders from '@0x/subproviders'\nexport { subproviders }\n\nimport * as Connectors from './connectors'\nexport { Connectors }\n","import { ethers } from 'ethers'\nimport { Connector } from './connectors'\nimport Web3State from './state'\n\nexport const ManagerErrorCodes = ['UNEXPECTED_ERROR', 'ALL_CONNECTORS_INVALID'].reduce(\n  (accumulator, currentValue) => {\n    accumulator[currentValue] = currentValue\n    return accumulator\n  },\n  {}\n)\n\nconst unexpectedErrorMessage = 'web3-vanila encountered an unexpected internal error. See the console for details.'\nconst unexpectedError = Error(unexpectedErrorMessage)\nunexpectedError.code = ManagerErrorCodes.UNEXPECTED_ERROR\n\nconst initialWeb3State = {\n  account: undefined,\n  connectorName: undefined,\n  error: null,\n  networkId: undefined,\n  provider: undefined\n}\n\nfunction normalizeAccount(account) {\n  return account === null ? account : ethers.utils.getAddress(account)\n}\n\n// MutableRefObject, TODO\nfunction useRef(initialValue = null) {\n  const ref = {\n    current: initialValue\n  }\n  return ref\n}\n\n// MutableRefObject, TODO\nfunction useRefId() {\n  const refId = useRef(0)\n\n  function increment() {\n    refId.current += 1\n  }\n\n  return [refId, increment]\n}\n\nclass Web3Manager {\n  constructor(connectors) {\n    [this.refId, this.incrementRefId] = useRefId()\n\n    this.connectors = connectors\n    this.web3State = new Web3State()\n  }\n\n  get web3Initialized() {\n    return !!(\n      this.web3State.account !== undefined &&\n      this.web3State.connectorName &&\n      !this.web3State.error &&\n      this.web3State.provider &&\n      this.web3State.networkId\n    )\n  }\n\n  get activeConnector() {\n    return this.web3State.connectorName\n      ? this.connectors[this.web3State.connectorName]\n      : undefined\n  }\n\n  updateWeb3State(state) {\n    this.web3State.account = state.account\n    this.web3State.connectorName = state.connectorName\n    this.web3State.error = state.error\n    this.web3State.networkId = state.networkId\n    this.web3State.provider = state.provider\n    this.web3State.active = this.web3Initialized\n  }\n\n  actionWeb3State(action) {\n    const state = {\n      account: this.web3State.account,\n      connectorName: this.web3State.connectorName,\n      error: this.web3State.error,\n      networkId: this.web3State.networkId,\n      provider: this.web3State.provider,\n    }\n\n    switch (action.type) {\n      case 'UPDATE_CONNECTOR_VALUES': {\n        const { connectorName, provider, networkId, account } = action.payload\n        return this.updateWeb3State({ connectorName, provider, networkId, account: normalizeAccount(account), error: null })\n      }\n      case 'UPDATE_NETWORK_ID': {\n        const { provider, networkId } = action.payload\n        return this.updateWeb3State({ ...state, provider: provider || state.provider, networkId, error: null })\n      }\n      case 'UPDATE_ACCOUNT': {\n        const { provider, account } = action.payload\n        return this.updateWeb3State({ ...state, provider: provider || state.provider, account: normalizeAccount(account), error: null })\n      }\n      case 'UPDATE_NETWORK_ID_AND_ACCOUNT': {\n        const { provider, networkId, account } = action.payload\n        return this.updateWeb3State({\n          ...state,\n          provider: provider || state.provider,\n          account: normalizeAccount(account),\n          error: null,\n          networkId\n        })\n      }\n      case 'SET_ERROR':\n        return this.updateWeb3State({ ...initialWeb3State, error: action.payload })\n      case 'SET_ERROR_PRESERVE_CONNECTOR_NAME':\n        return this.updateWeb3State({ ...initialWeb3State, connectorName: state.connectorName, error: action.payload })\n      case 'SET_ERROR_WITH_CONNECTOR_NAME': {\n        const { connectorName, error } = action.payload\n        return this.updateWeb3State({ ...initialWeb3State, connectorName, error })\n      }\n      case 'RESET':\n        return this.updateWeb3State(initialWeb3State)\n      default: {\n        console.warn('Default case encountered in actionWeb3State. Please file an issue on Github.')\n        return this.updateWeb3State({ ...state, provider: undefined, networkId: undefined, account: undefined, error: unexpectedError })\n      }\n    }\n  }\n\n  // function to set the error state.\n  setError(error, { preserveConnector = true, connectorName } = {}) {\n    if (connectorName) {\n      this.actionWeb3State({\n        type: 'SET_ERROR_WITH_CONNECTOR_NAME',\n        payload: { error, connectorName }\n      })\n    }\n    if (preserveConnector) {\n      this.actionWeb3State({\n        type: 'SET_ERROR_PRESERVE_CONNECTOR_NAME',\n        payload: error\n      })\n    } else {\n      this.actionWeb3State({\n        type: 'SET_ERROR',\n        payload: error\n      })\n    }\n  }\n\n  offConnector() {\n    const activeConnector = this.activeConnector\n\n    if (activeConnector) {\n      this._web3UpdateHandler && activeConnector.removeListener('_web3Update', this._web3UpdateHandler)\n      this._web3ErrorHandler && activeConnector.removeListener('_web3Error', this._web3ErrorHandler)\n      this._web3ResetHandler && activeConnector.removeListener('_web3Reset', this._web3ResetHandler)\n\n      activeConnector.onDeactivation(this.web3State.error)\n    }\n  }\n\n  onConnector() {\n    const activeConnector = this.activeConnector\n    if (activeConnector) {\n      this._web3UpdateHandler = this.web3UpdateHandler.bind(this)\n      this._web3ErrorHandler = this.web3ErrorHandler.bind(this)\n      this._web3ResetHandler = this.web3ResetHandler.bind(this)\n\n      activeConnector.on('_web3Update', this._web3UpdateHandler)\n      activeConnector.on('_web3Error', this._web3ErrorHandler)\n      activeConnector.on('_web3Reset', this._web3ResetHandler)\n    }\n  }\n\n  // function to set a connector\n  async setConnector(\n    connectorName,\n    { suppressAndThrowErrors = false, networkId } = {}\n  ) {\n    const callingTimeRefId = this.refId.current\n    this.incrementRefId()\n\n    const validConnectorNames = Object.keys(this.connectors)\n    const connector = this.connectors[connectorName]\n\n    if (!validConnectorNames.includes(connectorName)) {\n      console.warn(`'${connectorName}' is not a valid name, please pass one of: ${validConnectorNames.join(', ')}.`)\n      return\n    }\n\n    if (connectorName === this.web3State.connectorName) {\n      console.warn(\n        `'${connectorName}' is already set. Calling 'setConnector' for a connector while it is active is a no-op.'`\n      )\n      return\n    }\n\n    // at this point, begin initializing the connector\n    try {\n      await connector.onActivation()\n      const provider = await connector.getProvider(networkId)\n      const networkIdPromise = connector.getNetworkId(provider)\n      const accountPromise = connector.getAccount(provider)\n      await Promise.all([networkIdPromise, accountPromise]).then(\n        ([networkId, account]) => {\n          if (this.refId.current !== callingTimeRefId + 1) {\n            console.warn(`Silently suppressing status update from stale connector '${connectorName}'.`)\n            return\n          }\n\n          this.actionWeb3State({\n            payload: { connectorName, provider, networkId, account },\n            type: 'UPDATE_CONNECTOR_VALUES'\n          })\n          this.onConnector()\n        }\n      )\n    } catch (error) {\n      // if the component has re-rendered since this function was called, eat the error\n      if (this.refId.current !== callingTimeRefId + 1) {\n        console.warn(`Silently handling error from '${connectorName}': ${error.toString()}`)\n        return\n      }\n\n      if (suppressAndThrowErrors) {\n        throw error\n      } else {\n        this.setError(error, { connectorName })\n      }\n    }\n  }\n\n  // expose a wrapper to set the first valid connector in a list\n  async setFirstValidConnector(\n    connectorNames,\n    { suppressAndThrowErrors = false, networkIds = [] } = {}\n  ) {\n    for (const connectorName of connectorNames) {\n      try {\n        await this.setConnector(connectorName, {\n          suppressAndThrowErrors: true,\n          networkId: networkIds[connectorNames.indexOf(connectorName)]\n        })\n        break\n      } catch (error) {\n        if (connectorName === connectorNames[connectorNames.length - 1]) {\n          const error = Error('Unable to set any valid connector.')\n          error.code = ManagerErrorCodes.ALL_CONNECTORS_INVALID\n\n          if (suppressAndThrowErrors) {\n            throw error\n          } else {\n            this.setError(error)\n          }\n        }\n      }\n    }\n  }\n\n  // function to unset the current connector\n  unsetConnector() {\n    this.offConnector()\n    this.actionWeb3State({ type: 'RESET' })\n  }\n\n  async web3UpdateHandler({\n    updateNetworkId = false,\n    updateAccount = false,\n    overrideNetworkIdCheck = false,\n    overrideAccountCheck = false,\n    networkId,\n    account\n  } = {}) {\n    if (!this.activeConnector) {\n      console.warn('No active connector in web3UpdateHandler call. Please file an issue on Github.')\n      this.setError(unexpectedError)\n      return\n    }\n\n    if (\n      (!updateNetworkId && !updateAccount) ||\n      (updateNetworkId && overrideNetworkIdCheck && !networkId) ||\n      (updateAccount && overrideAccountCheck && !account)\n    ) {\n      console.warn('Malformed parameters passed to web3UpdateHandler.')\n      this.setError(unexpectedError)\n\n      return\n    }\n\n    // no checks required\n    if (\n      (!updateNetworkId || (updateNetworkId && overrideNetworkIdCheck)) &&\n      (!updateAccount || (updateAccount && overrideAccountCheck))\n    ) {\n      if (updateNetworkId && !updateAccount) {\n        this.actionWeb3State({\n          payload: { networkId },\n          type: 'UPDATE_NETWORK_ID'\n        })\n      } else if (!updateNetworkId && updateAccount) {\n        this.actionWeb3State({\n          payload: { account },\n          type: 'UPDATE_ACCOUNT'\n        })\n      } else {\n        this.actionWeb3State({\n          payload: { networkId, account },\n          type: 'UPDATE_NETWORK_ID_AND_ACCOUNT'\n        })\n      }\n\n      return\n    }\n\n    // one or more checks required\n    try {\n      const fetchNewProvider = !this.web3State.provider || (updateNetworkId && !overrideNetworkIdCheck)\n      const provider = await (fetchNewProvider ? this.activeConnector.getProvider(networkId) : this.web3State.provider)\n\n      const fetchNewNetworkId = this.web3State.networkId === undefined || (updateNetworkId && !overrideNetworkIdCheck)\n      const networkIdPromise =\n        this.web3State.networkId === undefined || fetchNewNetworkId\n          ? this.activeConnector.getNetworkId(provider)\n          : this.web3State.networkId\n\n      const fetchNewAccount = this.web3State.account === undefined || (updateAccount && !overrideAccountCheck)\n      const accountPromise =\n        this.web3State.account === undefined || fetchNewAccount ? this.activeConnector.getAccount(provider) : this.web3State.account\n\n      await Promise.all([networkIdPromise, accountPromise]).then(\n        ([returnedNetworkId, returnedAccount]) => {\n          if (updateNetworkId && networkId && networkId !== returnedNetworkId) {\n            console.warn(`Mismatched networkIds in web3UpdateHandler: ${networkId} and ${returnedNetworkId}.`)\n            throw unexpectedError\n          }\n\n          if (updateAccount && account && normalizeAccount(account) !== normalizeAccount(returnedAccount)) {\n            console.warn(\n              `Mismatched accounts in web3UpdateHandler: ${normalizeAccount(account)} and ${normalizeAccount(\n                returnedAccount\n              )}.`\n            )\n            throw unexpectedError\n          }\n\n          if (fetchNewNetworkId && !fetchNewAccount) {\n            this.actionWeb3State({\n              payload: { provider: fetchNewProvider ? provider : undefined, networkId: returnedNetworkId },\n              type: 'UPDATE_NETWORK_ID'\n            })\n          } else if (!fetchNewNetworkId && fetchNewAccount) {\n            this.actionWeb3State({\n              payload: { provider: fetchNewProvider ? provider : undefined, account: returnedAccount },\n              type: 'UPDATE_ACCOUNT'\n            })\n          } else {\n            this.actionWeb3State({\n              payload: {\n                provider: fetchNewProvider ? provider : undefined,\n                networkId: returnedNetworkId,\n                account: returnedAccount\n              },\n              type: 'UPDATE_NETWORK_ID_AND_ACCOUNT'\n            })\n          }\n        }\n      )\n    } catch (error) {\n      this.setError(error)\n    }\n  }\n\n  web3ErrorHandler(error, preserveConnector = true) {\n    this.setError(error, { preserveConnector })\n  }\n\n  web3ResetHandler() {\n    this.unsetConnector()\n  }\n}\n\nexport default Web3Manager\n","import { ethers } from 'ethers'\nimport Web3Manager from './manager'\n\nclass Web3Provider {\n  constructor({ connectors, libraryName = null, web3Api = null }) {\n    this._libraryName = libraryName\n    this.web3Api = web3Api\n\n    this._web3Manger = new Web3Manager(connectors)\n\n    this.setConnector = this._web3Manger.setConnector.bind(this._web3Manger)\n    this.setFirstValidConnector = this._web3Manger.setFirstValidConnector.bind(this._web3Manger)\n    this.unsetConnector = this._web3Manger.unsetConnector.bind(this._web3Manger)\n    this.setError = this._web3Manger.setError.bind(this._web3Manger)\n  }\n\n  get library() {\n    const providerToInject =\n      this.provider &&\n      (() => {\n        switch (this._libraryName) {\n          case 'ethers.js':\n            this.web3Api = ethers\n            return new ethers.providers.Web3Provider(this.provider)\n          case 'web3.js':\n            if (!this.web3Api) {\n              const error = Error('web3Api is not exists.')\n              error.code = 'WEB3_API_NOT_EXISTS'\n\n              throw error\n            }\n\n            return new this.web3Api(this.provider)\n          case null:\n            return this.provider\n        }\n      })()\n    return providerToInject\n  }\n\n  get event() {\n    return this._web3Manger.web3State\n  }\n\n  get connector() {\n    return this._web3Manger.activeConnector\n  }\n\n  get active() {\n    return this._web3Manger.web3State.active\n  }\n\n  get connectorName() {\n    return this._web3Manger.web3State.connectorName\n  }\n\n  get provider() {\n    return this._web3Manger.web3State.provider\n  }\n\n  get networkId() {\n    return this._web3Manger.web3State.networkId\n  }\n\n  get account() {\n    return this._web3Manger.web3State.account\n  }\n\n  get error() {\n    return this._web3Manger.web3State.error\n  }\n}\n\nexport default Web3Provider\n","import EventEmitter from 'events'\n\nclass Web3State extends EventEmitter {\n  constructor() {\n    super()\n\n    // init\n    this._account = undefined\n    this._connectorName = undefined\n    this._error = null\n    this._networkId = undefined\n    this._provider = undefined\n    this._active = false\n  }\n\n  // getter\n  get account() {\n    return this._account\n  }\n\n  get connectorName() {\n    return this._connectorName\n  }\n\n  get error() {\n    return this._error\n  }\n\n  get networkId() {\n    return this._networkId\n  }\n\n  get provider() {\n    return this._provider\n  }\n\n  get active() {\n    return this._active\n  }\n\n  // setter\n  set account(_account) {\n    if (_account !== this._account) {\n      this._account = _account\n      this.emit('accountChanged', _account)\n    }\n  }\n\n  set connectorName(_connectorName) {\n    if (_connectorName !== this._connectorName) {\n      this._connectorName = _connectorName\n      this.emit('connectorChanged', _connectorName)\n    }\n  }\n\n  /*\n    For all EventEmitter objects, if an 'error' event handler is not provided,\n    the error will be thrown, causing the Node.js process to report an uncaught\n    exception and crash unless either: The domain module is used appropriately\n    or a handler has been registered for the 'uncaughtException' event.\n  */\n  set error(_error) {\n    if (_error !== this._error) {\n      this._error = _error\n\n      if (_error)\n        this.emit('error', _error)\n    }\n  }\n\n  set networkId(_networkId) {\n    if (_networkId !== this._networkId) {\n      this._networkId = _networkId\n      this.emit('networkChanged', _networkId)\n    }\n  }\n\n  set provider(_provider) {\n    if (_provider !== this._provider) {\n      this._provider = _provider\n      this.emit('providerChanged', _provider)\n    }\n  }\n\n  set active(_active) {\n    if (_active !== this._active) {\n      this._active = _active\n      this.emit('active', _active)\n    }\n  }\n}\n\nexport default Web3State\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0x_subproviders__;","module.exports = __WEBPACK_EXTERNAL_MODULE_ethers__;","module.exports = require(\"events\");"],"sourceRoot":""}